<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>监控模式 </title>
    <meta name="author" content="hongbing" />
    <meta name="renderer" content="webkit">
    <meta name="description" content="hongbing的部落格" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="/css/default.css" type="text/css" />
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
    <link rel="shortcut icon" href="/jinchuan.png" type="image/x-icon" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="" />
    <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>
</head>
<body>
      <div id="header_wrap" class="outer">
        <header class="inner">
                <div id="project_title" align="center"><a href="/">hongbingの部落格</a></div>
                <div id="project_tagline" align="center">ONCE A GEEK, FOREVER A GEEK</div>
    <!--    
	        <div id="nav" class="navbar">
                         <div id="home" class="navbar"><a href="/">Home</a></div>
                         <div id="archive" class="navbar"><a href="/archive">Archive</a></div>
                         <div id="about" class="navbar"><a href="/about">About</a></div>
                </div>
-->	</header>
</div>
 
         <link rel="stylesheet" href="/js/prettify/prettify.css" />
<style type="text/css">
    body { background:#e8e8e8; }
    @media screen and (max-width: 750px){
        body { background:#fff; }
    }
    @media screen and (max-width: 1020px){
        body { background:#fff; }
    }
</style>

<div id="content">
    <div class="entry">
        <h1 class="entry-title"><a href="/posts/blog/15/11/14/monitor-principle.html" title="监控模式">监控模式</a></h1>
        <p class="entry-date">2015-11-14</p>
<!--
	
-->
	<p><em>文章来源<a href="http://everythingsysadmin.com/2013/11/stop-monitoring-if-service-is-up.html">stop-monitoring-if-service-is-up</a></em>
由于最近组内在对各个项目的监控做梳理，并完善各个项目的监控报警，所以对监控方面关注的比较多些。</p>

<p>在作者看来，99%的监控都没搞对。大多数人认为的监控是这样的：</p>

<ul>
  <li><strong>1.系统有什么东西出问题了。</strong></li>
  <li><strong>2.报警给我。</strong></li>
  <li>3.以最快的速度解决。</li>
  <li>4.快到小于RTO（recovery time objective）。</li>
</ul>

<p>哦（满头大汗！！！），幸好没整个故障出来。如果对于监控的认识与上面是一致的，那么系统经常会与故障相伴。
<!-- more -->
作者理解的监控是这样的：</p>

<ul>
  <li><strong>1.收到报警有的东西不在状态，需要修复，否则会出故障。</strong></li>
  <li><strong>2.在出故障之前修复掉。</strong></li>
  <li>3.轻松搞定。</li>
  <li>4.用户无感知。</li>
</ul>

<p>也许你已经看明白了，作者理解的监控与大多数人认为的监控的差别，第1步与第2步的顺序，然而不止如此，它们是对于监控两种不同的认知。一个是出问题了，监控告知，快速修复的对问题的反应式方式，另一个是监控显示可能某处会出问题，快速处理的主动出击的方式。一个略显被动的处理问题，一个却是<code class="highlighter-rouge">主动</code>的，在问题出现之前就化解了。
那么怎样做到作者提出的监控的模式？</p>

<ul>
  <li><strong>1.删除监控系统中的所有报警(略显暴力哈)</strong></li>
  <li><strong>2.每次遇到故障，思考什么样的监控数据可以预测到这种故障的发生</strong></li>
  <li><strong>3.更新监控，收集监控数据，添加必要的报警</strong></li>
  <li><strong>4.重复上面的操作。最终利用报警阻止故障的发生，而不是应对故障。</strong></li>
</ul>

<p>所以，在设计监控报警的时候，应该将报警设置在最底层，离最终用户越远，越能尽快发现并解决问题。当然，监控项除了报警还有一个作用就是问题的排查，这个就需要在各个关键路径都有相应数据的监控指标。</p>

<p>当然，没有完美的监控，并不能将所有的情况都早早的监控到，因此在我们设计系统的时候，都应该将监控思考进去，一些可能的点包括但不限于：</p>

<blockquote>
  <p>多条网络线路，其中一条无效，报警；存储使用raid，其中一块硬盘出故障，报警；
监控磁盘空间，ram使用，设置冗余，超过就报警；使用负载均衡器来转发web sever的请求；
……</p>
</blockquote>

<p>监控，一定要是显示在界面上，能够让外行轻易看懂的才叫监控，在日志里面的只能称之为数据，不叫监控。</p>

<p><img src="/images/monitor/monitor.jpg" alt="monitor" /></p>

	<ul class="pager">
            
            <li class="previous"><a href="/posts/blog/15/11/14/jetty-deadlock.html" title="jetty6 deadlock">上一篇 jetty6 deadlock</a></li>
	    

            
            <li class="next"><a href="/posts/blog/16/04/17/a-oom-problem.html" title="一次oom的排查过程">下一篇 一次oom的排查过程</a></li>
            
	</ul>
	<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//hongbing.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

    </div>

    <div class="sidenav">
	<iframe width="100%" height="85" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=85&fansRow=2&ptype=1&speed=0&skin=1&isTitle=0&noborder=0&isWeibo=0&isFans=0&uid=2702608131&verifier=f3af5509&dpc=1"></iframe>
    </div>

    <div class="sidenav">
        <h2>Blog</h2>
        <ul class="artical-list">
        
            <li><a href="/posts/blog/17/02/12/spring-session.html">spring session源码解析</a></li>
        
            <li><a href="/posts/blog/16/05/21/linux-common-command.html">工作中常用的linux命令</a></li>
        
            <li><a href="/posts/blog/16/05/19/hardware-interrupt-balance.html">硬件中断均衡</a></li>
        
            <li><a href="/posts/blog/16/04/17/a-oom-problem.html">一次oom的排查过程</a></li>
        
            <li><a href="/posts/blog/15/11/14/monitor-principle.html">监控模式</a></li>
        
            <li><a href="/posts/blog/15/11/14/jetty-deadlock.html">jetty6 deadlock</a></li>
        
            <li><a href="/posts/blog/15/08/21/linux-of-blockdump.html">linux系统之block_dump</a></li>
        
            <li><a href="/posts/blog/15/08/20/linux-of-pdflush.html">linux系统之pdflush</a></li>
        
            <li><a href="/posts/blog/15/08/11/UnknowHostException.html">UnknowHostException</a></li>
        
            <li><a href="/posts/blog/15/08/02/haproxy-install.html">haproxy部署</a></li>
        
            <li><a href="/posts/blog/15/07/25/maven-introduce.html">maven实践</a></li>
        
            <li><a href="/posts/blog/15/06/21/etcd-vs-consul.html">ETCD vs. Consul</a></li>
        
            <li><a href="/posts/blog/15/06/21/distributed-id-generator.html">分布式ID生成器</a></li>
        
            <li><a href="/posts/blog/15/06/17/what-is-good-code.html">什么样的代码才是好的代码</a></li>
        
            <li><a href="/posts/blog/15/06/17/raft-introduce.html">Raft</a></li>
        
        </ul>
<!--
        <h2>Opinion</h2>
        <ul class="artical-list">
        
        </ul>

        <h2>Project</h2>
        <ul class="artical-list">
        
        </ul>-->
     </div>
</div>
<script src="/js/jquery-1.7.1.min.js"" type="text/javascript"></script>
<script src="/js/post.js" type="text/javascript"></script>

      

</body>
</html>

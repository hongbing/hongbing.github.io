<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Hongbing Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="http://hongbing.github.io//img/home-bg.jpg">
    <meta property="twitter:image" content="http://hongbing.github.io//img/home-bg.jpg" />
    

    
    <meta name="title" content="maven介绍" />
    <meta property="og:title" content="maven介绍" />
    <meta property="twitter:title" content="maven介绍" />
    

    
    <meta name="description" content="靳洪兵，来自重庆，软件工程师，北漂，一个无聊的人">
    <meta property="og:description" content="靳洪兵，来自重庆，软件工程师，北漂，一个无聊的人" />
    <meta property="twitter:description" content="靳洪兵，来自重庆，软件工程师，北漂，一个无聊的人" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="靳洪兵, Jinhongbing, hongbing, Hongbing Blog, 博客, 个人网站, 互联网, Web">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>maven介绍-洪兵的博客</title>

    <link rel="canonical" href="/post/2015-07-25-maven-introduce/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>

    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Hongbing Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/tech">tech</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/home-bg.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/maven" title="maven">
                            maven
                        </a>
                        
                    </div>
                    <h1>maven介绍</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                            hongbing
                         
                        on 
                        2015-07-25
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>目录</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-相关概念">1 相关概念</a></li>
        <li><a href="#2-maven实践">2 maven实践</a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <h2 id="1-相关概念">1 相关概念</h2>
<h3 id="11-版本号">1.1 版本号</h3>
<p>版本号记录一个项目在某个阶段的某些功能的实现，实现项目中不同功能的隔离与区分。
版本号格式一般分为：</p>
<p><code>主版本号.分支版本号.小版本号-里程碑版本号</code></p>
<p><strong>主版本号</strong>：一般指框架具有重大变化的版本号，比如struts1，struts2框架的变化</p>
<p><strong>分支版本号</strong>： 一般指功能的变化</p>
<!-- raw HTML omitted -->
<p><strong>小版本号</strong>：bug的修复</p>
<p><strong>里程碑版本号</strong>：<code>SNAPSHOT</code>&ndash;&gt;<code>RELEASAE</code>&ndash;&gt;<code>FINAL</code></p>
<h3 id="12-仓库分类">1.2 仓库分类</h3>
<p>狭义上讲，仓库分为两种，一种是本地仓库，一种是远程仓库。</p>
<p>广义上讲，远程仓库也可分为私有仓库和中心仓库，也即是分为三种：本地仓库，私有仓库和中心仓库</p>
<h4 id="121-本地仓库">1.2.1 本地仓库</h4>
<p>即为本地的./.m2/repository文件夹，项目中需要的jar包都会被保存在本地仓库中，项目的更新操作（commit操作）都会首先同步到本地仓库中。</p>
<h4 id="122-私有仓库">1.2.2 私有仓库</h4>
<p>局域网内部的仓库，当本地仓库没有项目中所需要的jar包时，从私有仓库中找，如果存在，就将其下载到本地仓库中。同时，针对多人协作开发，可以将不同的开发版本deploy到私有仓库中。
私有仓库的作用为：提升查找jar包的速度，进行项目版本管理。</p>
<p>（注：使用commit and push命令只会将本地的代码提交到仓库中，使用deploy才会在仓库中为此项目打一个jar或者war包。）</p>
<p>私有仓库中的仓库类型也分为几类：</p>
<blockquote>
<p><strong>RELEASE</strong>：项目发布版本的存放地</p>
</blockquote>
<blockquote>
<p><strong>SNAPSHOT</strong>：项目开发版本的存放地</p>
</blockquote>
<blockquote>
<p><strong>3rd party</strong>：第三方项目，后者是第三方jar包的存放地，这个里面的内容一般由内部人员添加.</p>
</blockquote>
<blockquote>
<p><strong>group</strong>：将仓库中的多个内容添加到一起组成一个group，这样在项目的pom.xml文件中指定所需要的jar包时就可以通过group的方式，而不必每一个jar包都下一个dependency。</p>
</blockquote>
<p>
  <img src="/img/maven/repository.png" alt="私有仓库示例">

</p>
<h4 id="123-中心仓库">1.2.3 中心仓库</h4>
<p>maven远程服务器管理的仓库，地址是<a href="http://repo1.maven.org.maven2">maven中心仓库</a></p>
<h3 id="13-项目的发布">1.3 项目的发布</h3>
<p>在项目中添加</p>
<pre><code>&lt;distributeManagement&gt;
    &lt;snapshotRepository&gt;
    &lt;id&gt;firehose.0.0.1-snapshot&lt;/id&gt;
    &lt;name&gt;firehose-SNAPSHOT&lt;/name&gt;
    &lt;url&gt;10.30.XXX.XXX/nexus/content/Repositories/snapshots/&lt;/url&gt;
    &lt;/snapshotRepository&gt;
&lt;/distributeManagement&gt;
</code></pre><p>使用<code>mvn deploy</code>命令即可将项目发布到私有仓库中，也即是上面的url中</p>
<h3 id="14-maven的生命周期">1.4 maven的生命周期</h3>
<p>maven的3种独立的生命周期</p>
<ul>
<li><strong>clean</strong></li>
</ul>
<p>pre-clean 准备清理工作</p>
<p>clean 清理</p>
<p>post-clean 清理后需要做的工作</p>
<ul>
<li><strong>compile</strong></li>
</ul>
<p>validate</p>
<p>generate-sources</p>
<p>process-sources</p>
<p>generate-resources</p>
<p>process-resources     复制并处理资源文件，至目标目录，准备打包。</p>
<p>compile     编译项目的源代码。</p>
<p>process-classes</p>
<p>generate-test-sources</p>
<p>process-test-sources</p>
<p>generate-test-resources</p>
<p>process-test-resources     复制并处理资源文件，至目标测试目录。</p>
<p>test-compile     编译测试源代码。</p>
<p>process-test-classes</p>
<p>test     使用合适的单元测试框架运行测试。这些测试代码不会被打包或部署。</p>
<p>prepare-package</p>
<p>package     接受编译好的代码，打包成可发布的格式，如 JAR 。</p>
<p>pre-integration-test</p>
<p>integration-test</p>
<p>post-integration-test</p>
<p>verify</p>
<p>install     将包安装至本地仓库，以让其它项目依赖。</p>
<p>deploy     将最终的包复制到远程的仓库，以让其它开发人员与项目共享。</p>
<ul>
<li><strong>site</strong></li>
</ul>
<p>pre-site     执行一些需要在生成站点文档之前完成的工作</p>
<p>site    生成项目的站点文档</p>
<p>post-site     执行一些需要在生成站点文档之后完成的工作，并且为部署做准备</p>
<p>site-deploy     将生成的站点文档部署到特定的服务器上</p>
<p><strong>clean</strong>、<strong>compile</strong> 和 <strong>site</strong> 这三个生命周期是不相关的。执行每一个生命周期，其前面的所有阶段都会被执行。生命周期中的每一个操作都是以插件机制完成的。</p>
<h2 id="2-maven实践">2 maven实践</h2>
<h3 id="21-手动添加jar包到仓库">2.1 手动添加jar包到仓库</h3>
<p><strong>本地仓库</strong></p>
<pre><code>mvn install:install-file -DgroupId=jar的groupId
-DartifactId=jar的artifactId -Dversion=jar的version
 -Dfile=jar包的路径 -Dpackaging=jar
</code></pre><p>一个命令将二进制，源码和javadoc都上传到本地仓库：</p>
<pre><code>mvn install:install-file  -DgroupId=jar的groupId
-DartifactId=jar的artifactId -Dversion=jar的version
-Dfile=二进制jar包的路径  -Dsources=sources jar包的路径
-Djavadoc=javadoc jar包的路径
</code></pre><p><strong>远程仓库</strong></p>
<pre><code>mvn deploy:deploy-file  -DgroupId=jar的groupId
-DartifactId=jar的artifactId -Dversion=jar的version
-Dfile=二进制jar包的路径  -Dsources=sources jar包的路径
-Djavadoc=javadoc jar包的路径
</code></pre><p><em>注：在上述命令后都可以指定上传的仓库地址，在命令后面添加<code>-url=file://path/to/repository</code>，如果没有指定则会依据maven的setting.xml中的配置</em></p>
<p>添加到maven库中后，使用该jar包时需要修改maven工程的pom.xml文件，将添加的jar包加入到pom.xml文件中即可使用。</p>
<h3 id="22-maven创建web-app">2.2 maven创建web-app</h3>
<p>使用maven创建web-app，需要自行建文件夹src/main/java包。</p>
<p>支持web-app发布到tomcat的插件：cargo</p>
<p>支持web-app发布到jetty的插件：jetty-maven-plugin</p>
<h3 id="23-maven查找包依赖">2.3 maven查找包依赖</h3>
<ul>
<li>使用maven project report插件来显示所有的项目依赖关系</li>
</ul>
<p>在项目pom.xml的<!-- raw HTML omitted --><!-- raw HTML omitted -->里添加 maven插件maven-project-info-reports-plugin：</p>
<pre><code>&lt;reporting&gt;
  &lt;plugins&gt;
   &lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;
     maven-project-info-reports-plugin
    &lt;/artifactId&gt;
     &lt;version&gt;2.4&lt;/version&gt;
   &lt;/plugin&gt;
 &lt;/plugins&gt;
 &lt;/reporting&gt;
</code></pre><p>使用这个插件，然后执行命令：</p>
<p><code>mvn  project-info-reports:dependencies</code></p>
<p>就可以在target/site/dependencies.html里查看依赖报表，通过这个报表就能够找到冲突的版本，然后再使用exclusions来排除相关的包。</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.x.y&lt;/groupId&gt;
    &lt;artifactId&gt;xyz&lt;/artifactId&gt;
    &lt;version&gt;1.1.1&lt;/version&gt;
    &lt;exclusions&gt;
            &lt;exclusion&gt;
                    &lt;groupId&gt;com.u.v&lt;/groupId&gt;
                    &lt;artifactId&gt;uvw&lt;/artifactId&gt;
                    &lt;version&gt;0.9.1&lt;/version&gt;
            &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
</code></pre><p>另外使用命令</p>
<p><code>mvn dependency:analyze</code></p>
<p>可以分析出显示声明但没有依赖的包，可以将其去除。</p>
<ul>
<li>使用脚本显示循环依赖包</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ff79c6">#!/bin/bash
</span><span style="color:#ff79c6"></span><span style="color:#6272a4">### find cycle in maven depnedency tree</span>

<span style="color:#ff79c6">if</span> <span style="color:#ff79c6">[</span> <span style="color:#8be9fd;font-style:italic">$#</span> -gt <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">]</span>;<span style="color:#ff79c6">then</span>
    <span style="color:#8be9fd;font-style:italic">sourcepath</span><span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">$1</span>
<span style="color:#ff79c6">else</span>
    <span style="color:#8be9fd;font-style:italic">sourcepath</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">`</span><span style="color:#8be9fd;font-style:italic">pwd</span><span style="color:#f1fa8c">`</span>
<span style="color:#ff79c6">fi</span>
<span style="color:#ff79c6">if</span> <span style="color:#ff79c6">[</span> ! -f <span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$sourcepath</span><span style="color:#f1fa8c">/pom.xml&#34;</span> <span style="color:#ff79c6">]</span>; <span style="color:#ff79c6">then</span>
    <span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$sourcepath</span><span style="color:#f1fa8c"> is not a vaild maven project!&#34;</span>
    <span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;Usage : ./findcycle [path]&#39;</span>
    <span style="color:#8be9fd;font-style:italic">exit</span> 1;
<span style="color:#ff79c6">fi</span>
<span style="color:#8be9fd;font-style:italic">mvn</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">`</span>which mvn<span style="color:#f1fa8c">`</span>
<span style="color:#ff79c6">if</span> <span style="color:#ff79c6">[</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#8be9fd;font-style:italic">$mvn</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">]</span>;<span style="color:#ff79c6">then</span>
    <span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;counld not found mvn in PATH,exit!&#34;</span>
    <span style="color:#8be9fd;font-style:italic">exit</span> 1;
<span style="color:#ff79c6">fi</span>

<span style="color:#8be9fd;font-style:italic">cd</span> <span style="color:#8be9fd;font-style:italic">$sourcepath</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;scan cycle dependency in </span><span style="color:#8be9fd;font-style:italic">$sourcepath</span><span style="color:#f1fa8c"> ...&#34;</span>
mvn dependency:tree -Dverbose | awk -F<span style="color:#f1fa8c">&#39;- &#39;</span> <span style="color:#f1fa8c">&#39;{if(index($2,&#34;maven-dependency-plugin&#34;)&gt;0){indent=0;}else{indent=length($1);}stack[indent]=$2;if(index($0,&#34;for cycle&#34;)&gt;0){print &#34;****found cycle****&#34;;for(i=0;i&lt;=indent;i++){if(stack[i]!=null){print &#34;-&gt;&#34;stack[i]}}}}&#39;</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;scan finished!&#34;</span>
</code></pre></div><p>使用上面的脚本（将其放置于工程目录下，或者指定工程路径）检测是否存在循环依赖，如果存在，会输出循环依赖的链。（此脚本取自于@秦迪 <a href="http://blog.2baxb.me">Axb的自我修养</a>）</p>
<p>附 <a href="/script/findCycle.sh">findClycle.sh</a></p>
<p>
  <img src="/img/maven/jewel.jpg" alt="jewel">

</p>


                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/2015-06-21-etcd-vs-consul/" data-toggle="tooltip" data-placement="top" title="ETCD vs. Consul">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/2015-08-02-haproxy-install/" data-toggle="tooltip" data-placement="top" title="HAproxy部署">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/java" title="java">
                            java
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/linux" title="linux">
                            linux
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/redis" title="redis">
                            redis
                        </a>
                        
                        
                        
                        <a href="/tags/spring" title="spring">
                            spring
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
                
                    
                    
                    
                        
                        
                        
                    
                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="Hongbing Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fas fa-circle fa-stack-2x"></i>
                               <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:jasonjin2009@163.com">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    

                    
                    
                    

                    

		    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Hongbing Blog 2021
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
